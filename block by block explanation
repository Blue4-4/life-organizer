Header and Imports
#!/usr/bin/env python3
"""
Daily Journal Creator for Google Drive
Creates a new Google Doc with today's date in specified folder
"""
import os
from datetime import datetime
from google.auth.transport.requests import Request
from google_auth_oauthlib.flow import InstalledAppFlow
from googleapiclient.discovery import build
from googleapiclient.errors import HttpError


Declares it as a Python 3 executable script.

Imports modules for date handling and Google API access (google-auth, googleapiclient).

Global Configuration
SCOPES = ['https://www.googleapis.com/auth/drive.file',
          'https://www.googleapis.com/auth/documents']

JOURNAL_FOLDER_ID = "1iEVnYyRCJ3qmMFBwE_Dkht8TitFqSezS"
MASTER_DOC_LINK = "https://docs.google.com/document/d/1zHL1gIa_MwaJPGk_GL0LSq3Q1MjbP-wDkHh5lJ03R-o/edit?tab=t.0"


SCOPES defines what API permissions are requested (create/edit files + Docs).

JOURNAL_FOLDER_ID identifies the Drive folder where new journals are stored.

MASTER_DOC_LINK is a static reference link inserted into each new file.

Google Authentication
def get_credentials():
    """Get Google API credentials - prompts for authentication every time"""
    flow = InstalledAppFlow.from_client_secrets_file(
        'credentials.json', SCOPES)
    creds = flow.run_local_server(port=0)
    return creds


Starts OAuth 2.0 authorization from a local browser session using credentials.json.

Always requests new login (no token caching).

Returns an authenticated Credentials object.

Filename Generator
def get_today_filename():
    """Generate filename in format 'Sun - yymmdd'"""
    today = datetime.now()
    day_name = today.strftime('%a')
    date_format = today.strftime('%y%m%d')
    return f"{day_name} - {date_format}"


Builds a short filename like Tue - 251111.

Used to identify daily entries.

Duplicate Check
def check_document_exists(drive_service, folder_id, filename):
    """Check if document with filename already exists in folder"""
    try:
        query = f"name='{filename}' and parents in '{folder_id}' and mimeType='application/vnd.google-apps.document'"
        results = drive_service.files().list(q=query).execute()
        items = results.get('files', [])
        return len(items) > 0, items[0]['id'] if items else None
    except HttpError as error:
        print(f'An error occurred checking for existing document: {error}')
        return False, None


Uses the Drive API to search for an existing Doc with the same name.

Returns a Boolean and the document ID if found.

Prevents duplicate journal creation.

Document Creation
def create_google_doc(drive_service, docs_service, filename, folder_id):
    """Create a new Google Doc in the specified folder"""
    try:
        doc_metadata = {
            'name': filename,
            'parents': [folder_id],
            'mimeType': 'application/vnd.google-apps.document'
        }
        doc = drive_service.files().create(body=doc_metadata).execute()
        doc_id = doc.get('id')


Creates a blank Google Doc via Drive API with desired name + folder.

Saves the new file‚Äôs ID.

        document_body = {
            'requests': [{
                'insertText': {
                    'location': {'index': 1},
                    'text': f"""Master Reference: {MASTER_DOC_LINK}

Previous entry: 

Work Organization: 

[Today's edited notes go here]

"""
                }
            }]
        }
        docs_service.documents().batchUpdate(
            documentId=doc_id, 
            body=document_body
        ).execute()


Defines starter text using the Docs API batchUpdate request.

Inserts template text near document start (index: 1).

        return doc_id, f"https://docs.google.com/document/d/{doc_id}/edit"


Returns the document ID and URL for confirmation.

If an exception occurs, prints the error and returns None.

Main Workflow
def main():
    print("üöÄ Starting Daily Journal Creator...")
    print("üîê You will be prompted to authenticate with Google...")


Displays console prompts for status messages.

    try:
        creds = get_credentials()
        drive_service = build('drive', 'v3', credentials=creds)
        docs_service = build('docs', 'v1', credentials=creds)
        print("‚úÖ Successfully authenticated with Google APIs")
    except Exception as e:
        print(f"‚ùå Failed to authenticate: {e}")
        return


Authenticates and initializes both Drive and Docs service clients.

Exits if authentication fails.

    filename = get_today_filename()
    print(f"üìÖ Today's journal filename: {filename}")


Produces that day‚Äôs filename and logs it.

    exists, existing_doc_id = check_document_exists(drive_service, JOURNAL_FOLDER_ID, filename)
    if exists:
        existing_url = f"https://docs.google.com/document/d/{existing_doc_id}/edit"
        print(f"üìù Document already exists!")
        print(f"üîó URL: {existing_url}")
        return


Skips creation if a same-name document already exists.

    print("üìÑ Creating new journal document...")
    doc_id, doc_url = create_google_doc(drive_service, docs_service, filename, JOURNAL_FOLDER_ID)


Calls the creation function and retrieves the new URL.

    if doc_id:
        print(f"‚úÖ Successfully created journal entry!")
        ...
        import webbrowser
        user_input = input("\nüåê Open document in browser? (y/n): ").lower()
        if user_input == 'y':
            webbrowser.open(doc_url)
    else:
        print("‚ùå Failed to create document")


On success, prints metadata and optionally opens the new Doc in the default browser.

Execution Guard
if __name__ == "__main__":
    main()


Runs main() only when script is executed directly (not imported).

Summary

The program:

Authenticates to Google APIs.

Builds a filename for today.

Checks for an existing journal.

Creates a new Google Doc template if none exists.

Inserts boilerplate text.

Returns or opens the new document‚Äôs link.
